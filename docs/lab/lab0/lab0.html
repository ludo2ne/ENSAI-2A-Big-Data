<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rémi Pépin, Arthur Katossky, Ludovic Deneuville">
<meta name="description" content="Lab 0">

<title>Big Data - Discover Amazon Web Service (AWS)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Big Data</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-labs" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Labs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-labs">    
        <li>
    <a class="dropdown-item" href="../../../docs/lab/lab-setup.html">
 <span class="dropdown-text">Lab setup</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../docs/lab/lab0/lab0.html">
 <span class="dropdown-text">Lab 0</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../docs/lab/lab1/lab1.html">
 <span class="dropdown-text">Lab 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../docs/lab/lab2/lab2.html">
 <span class="dropdown-text">Lab 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../docs/lab/lab3/lab3.html">
 <span class="dropdown-text">Lab 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-aws" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">AWS</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-aws">    
        <li>
    <a class="dropdown-item" href="../../../docs/lab/aws-cluster-spark.html">
 <span class="dropdown-text">Create a Spark cluster</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-other-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Other resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-other-resources">    
        <li>
    <a class="dropdown-item" href="../../../docs/duckdb.html">
 <span class="dropdown-text">DuckDB</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../docs/bibliography.html"> 
<span class="menu-text">Bibliography</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ludo2ne/ENSAI-2A-Big-Data" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#log-on-aws" id="toc-log-on-aws" class="nav-link" data-scroll-target="#log-on-aws"><span class="header-section-number">1</span> Log on AWS</a></li>
  <li><a href="#exploration" id="toc-exploration" class="nav-link" data-scroll-target="#exploration"><span class="header-section-number">2</span> Exploration</a></li>
  <li><a href="#create-a-s3-bucket" id="toc-create-a-s3-bucket" class="nav-link" data-scroll-target="#create-a-s3-bucket"><span class="header-section-number">3</span> Create a S3 bucket</a></li>
  <li><a href="#import-some-files-to-your-bucket" id="toc-import-some-files-to-your-bucket" class="nav-link" data-scroll-target="#import-some-files-to-your-bucket"><span class="header-section-number">4</span> Import some files to your bucket</a></li>
  <li><a href="#ssh-key-creation" id="toc-ssh-key-creation" class="nav-link" data-scroll-target="#ssh-key-creation"><span class="header-section-number">5</span> SSH key creation</a></li>
  <li><a href="#create-your-first-virtual-machine" id="toc-create-your-first-virtual-machine" class="nav-link" data-scroll-target="#create-your-first-virtual-machine"><span class="header-section-number">6</span> Create your first virtual machine</a></li>
  <li><a href="#connect-to-the-ec2-instance" id="toc-connect-to-the-ec2-instance" class="nav-link" data-scroll-target="#connect-to-the-ec2-instance"><span class="header-section-number">7</span> Connect to the EC2 instance</a>
  <ul class="collapse">
  <li><a href="#windows-user" id="toc-windows-user" class="nav-link" data-scroll-target="#windows-user"><span class="header-section-number">7.1</span> Windows user</a></li>
  <li><a href="#macoslinux-user" id="toc-macoslinux-user" class="nav-link" data-scroll-target="#macoslinux-user"><span class="header-section-number">7.2</span> macOS/Linux user</a></li>
  </ul></li>
  <li><a href="#play-with-your-vm" id="toc-play-with-your-vm" class="nav-link" data-scroll-target="#play-with-your-vm"><span class="header-section-number">8</span> Play with your VM</a>
  <ul class="collapse">
  <li><a href="#benchmark-setup" id="toc-benchmark-setup" class="nav-link" data-scroll-target="#benchmark-setup"><span class="header-section-number">8.1</span> Benchmark setup</a></li>
  <li><a href="#install-r-java-c-compiler-and-a-python-package" id="toc-install-r-java-c-compiler-and-a-python-package" class="nav-link" data-scroll-target="#install-r-java-c-compiler-and-a-python-package"><span class="header-section-number">8.2</span> Install R, java, C compiler and a python package</a></li>
  <li><a href="#benchmark" id="toc-benchmark" class="nav-link" data-scroll-target="#benchmark"><span class="header-section-number">8.3</span> Benchmark</a></li>
  <li><a href="#a-shell-in-your-web-browser" id="toc-a-shell-in-your-web-browser" class="nav-link" data-scroll-target="#a-shell-in-your-web-browser"><span class="header-section-number">8.4</span> A shell in your web browser</a></li>
  </ul></li>
  <li><a href="#shut-down-your-machine" id="toc-shut-down-your-machine" class="nav-link" data-scroll-target="#shut-down-your-machine">Shut down your machine</a></li>
  <li><a href="#prepare-next-lab" id="toc-prepare-next-lab" class="nav-link" data-scroll-target="#prepare-next-lab">Prepare next Lab</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Discover Amazon Web Service (AWS)</h1>
</div>

<div>
  <div class="description">
    Lab 0
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rémi Pépin, Arthur Katossky, Ludovic Deneuville </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="objectives">Objectives</h2>
<p>The lab’s goal is to make you familiar with the AWS’s interface. In this lab, you will :</p>
<ul>
<li>Create an account on AWS academy if you haven’t done yet</li>
<li>Store some data on Amazon Simple Storage Service (AWS S3)</li>
<li>Create an Elastic Compute Cloud instance (= a virtual machine) and connect to it with SSH</li>
<li>Run some basic shell commands
<ul>
<li><code>ls</code> to list files in a directory</li>
<li><code>cd</code> to change the current directory</li>
<li><code>yum</code> to install a package</li>
<li><code>aws s3 cp</code> to copy file from S3</li>
<li><code>chmod</code> to change some file persmision</li>
<li><code>time [commande]</code> to compute some execution time</li>
</ul></li>
<li>Shut down your EC2 instance</li>
</ul>
</section>
<section id="log-on-aws" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="log-on-aws"><span class="header-section-number">1</span> Log on AWS</h2>
<ul class="task-list">
<li><label><input type="checkbox">Follow the instructions you get from the AWS academy’s e-mail, then those of the <a href="https://foad-moodle.ensai.fr/pluginfile.php/22636/mod_resource/content/0/AWS%20Academy%20Learner%20Lab%20-%20Student%20Guide.pdf">AWS Academy Learner Lab - Student Guide</a> to access to the AWS console.</label></li>
</ul>
<p>Your AWS account is located in North Virginia, <strong>do not change that</strong>.<br>
Because your account is for academic purpose, your don’t have access to all the AWS services.<br>
Your account is managed by AWS academy, so you have to use the AWS academy portal to access to your AWS account.</p>
<ul class="task-list">
<li><label><input type="checkbox"><a href="https://www.awsacademy.com/vforcesite/LMS_Login" class="external" target="_blank">Log to AWS</a></label></li>
<li><label><input type="checkbox">Go to the Dashboard</label></li>
<li><label><input type="checkbox">Select <code>AWS Academy Learner Lab [78065]</code></label></li>
<li><label><input type="checkbox">Click on <strong>Learner Lab</strong> to start a lab session!</label></li>
<li><label><input type="checkbox">🔴 The Lab is down <span class="emoji" data-emoji="arrow_right">➡️</span> <code>Start Lab</code></label></li>
<li><label><input type="checkbox">🟡 The dot next to AWS turns yellow, Wait 2 minutes</label></li>
<li><label><input type="checkbox">🟢 When the dot next to AWS turns green, your Lab is ready to use</label></li>
<li><label><input type="checkbox">Click <strong>AWS</strong></label></li>
</ul>
<p><a href="img/aws_console.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="img/aws_console.png" class="img-fluid"></a></p>
</section>
<section id="exploration" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="exploration"><span class="header-section-number">2</span> Exploration</h2>
<p>In the <code>Services</code> tab, you should find for instance :</p>
<ul>
<li>EC2 in computation</li>
<li>S3 in storage</li>
<li>A section for databases</li>
<li>A section for <em>machine-learning</em><br>
</li>
<li>A section for data analysis</li>
</ul>
</section>
<section id="create-a-s3-bucket" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="create-a-s3-bucket"><span class="header-section-number">3</span> Create a S3 bucket</h2>
<p><strong>Amazon Simple Storage Service</strong> (S3) is the standard solution to store data on AWS. Amazon assured a 99,999999999 % durability for your data. This mean, is you store 10 000 000 files on S3, you can on average expect to incur a loss of a single file every 10 000 years.</p>
<p>The storage is quite expensive (around ~0,02 $/Go/month), knowing that you pay for read operations (around ~0,09 \$/Go). 1 To cost around 240$ a year. For instance, a 1To SSD cost less than 100$ (for a smaller durability), and a cloud storage solution (like drop box) for private individual cost 10$/month for 2To (for the same durability). But the use case are different. S3 is for data access frequently by other AWS services. There is other storage solution (like S3 glacier) for archive, or databases.</p>
<p>All AWS services can natively read from and write to S3, if they have some access right. So, every application you deploy on AWS can import/export data from/to S3. A file stored in S3 is called an “object”, and can be access by a unique URL. You can limit access right to a specific file.</p>
<ul class="task-list">
<li><label><input type="checkbox">In the <code>search bar</code> type <code>S3</code></label></li>
<li><label><input type="checkbox">Click on <code>Create bucket</code></label></li>
<li><label><input type="checkbox">Bucket name : choose a unique name (ex: ensai-firstName-lastName-currentDate)</label></li>
<li><label><input type="checkbox">Keep all the default values</label></li>
<li><label><input type="checkbox">Create your bucket</label></li>
</ul>
</section>
<section id="import-some-files-to-your-bucket" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="import-some-files-to-your-bucket"><span class="header-section-number">4</span> Import some files to your bucket</h2>
<ul class="task-list">
<li><p><label><input type="checkbox">Select your bucket to go to its dedicated page</label></p>
<p><a href="img/s3_bucket.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="img/s3_bucket.png" class="img-fluid"></a></p></li>
<li><p><label><input type="checkbox">Click on <code>Upload</code>, and upload the file <a href="lab0_files.zip">Lab0_files.zip</a></label></p></li>
</ul>
<p><a href="img/s3_upload_file.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="img/s3_upload_file.png" class="img-fluid"></a></p>
<ul class="task-list">
<li><p><label><input type="checkbox">Once the upload finished, click on your file</label></p>
<ul>
<li>You will land on the file page, and found to link to access to your file. One is the URL of the file, the other is the S3 URI</li>
</ul></li>
<li><p><label><input type="checkbox">Copy your URI and keep it in a text file, you will need it later</label></p>
<p><a href="img/s3_file.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="img/s3_file.png" class="img-fluid"></a></p></li>
</ul>
</section>
<section id="ssh-key-creation" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="ssh-key-creation"><span class="header-section-number">5</span> SSH key creation</h2>
<p><strong>SSH</strong> (<strong>S</strong>ecure <strong>SH</strong>ell) protocol allow a secure remote connection to a machine. Moreover, with SSH you can control the remote machine. For more details, you can read this <a href="https://doc.fedora-fr.org/wiki/SSH_:_Authentification_par_cl%C3%A9" class="external" target="_blank">page</a>. But first you need a private key to authenticate yourself.</p>
<ul class="task-list">
<li><p><label><input type="checkbox">In the search bar, search <code>Key pairs</code></label></p></li>
<li><p><label><input type="checkbox">Click on <code>Create key pairs</code></label></p></li>
<li><p><label><input type="checkbox">Give it a name (ex: <code>labsuser</code>)</label></p>
<ul>
<li>select the ppk format if you use windows,</li>
<li>or pem if you use Linux / macOs</li>
</ul></li>
<li><p><label><input type="checkbox">Click on <code>Create key pair</code></label></p>
<ul>
<li>This will download your key, do not lost it !</li>
</ul></li>
<li><p><label><input type="checkbox">If you are on Linux / macOs open a terminal and type :</label></p>
<pre><code>cd ~/Downloads
chmod 400 labsuser.pem</code></pre>
<p>Do not close this terminal</p></li>
</ul>
</section>
<section id="create-your-first-virtual-machine" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="create-your-first-virtual-machine"><span class="header-section-number">6</span> Create your first virtual machine</h2>
<ul class="task-list">
<li><label><input type="checkbox">In the search bar, type <code>EC2</code></label></li>
<li><label><input type="checkbox">Click on <code>Launch instance</code></label></li>
<li><label><input type="checkbox">Amazon Machine Image (AMI): <code>Amazon Linux 2 AMI (HVM) - Kernel 5.10</code></label>
<ul>
<li>First, you must choose an image for your machine (called AMI pour Amazon Machine Image). This image contain an OS and some default applications.</li>
</ul></li>
<li><label><input type="checkbox">Instance type: <code>t2.micro</code></label>
<ul>
<li>Then you will select the hardware configuration. For instance, for a general usage machine you can choose a <code>t2.micro</code> for a cheap but weak machine (0.012$/hour, 1 core, 1Go Ram) or a more powerful and more expensive one like <code>t2.xlarge</code> (0.188$/hour, 8 core, 32Go Ram). Because you pay for how long your EC2 instance are up, turn off you machine at the end of the lab !</li>
</ul></li>
<li><label><input type="checkbox">Key pair name: select the key pair you created earlier</label></li>
<li><label><input type="checkbox">At the bottom, click on <code>Advanced details</code></label></li>
<li><label><input type="checkbox">IAM instance profile: <code>LabInstanceProfile</code></label></li>
<li><label><input type="checkbox"><code>Launch instance</code></label></li>
</ul>
<p>Congrats! Your VM is launching.</p>
<ul class="task-list">
<li><label><input type="checkbox">Go back to <em>EC2</em> page and then <em>Instances</em></label></li>
<li><label><input type="checkbox">Refresh until your instance state is running</label></li>
</ul>
</section>
<section id="connect-to-the-ec2-instance" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="connect-to-the-ec2-instance"><span class="header-section-number">7</span> Connect to the EC2 instance</h2>
<ul class="task-list">
<li><p><label><input type="checkbox">Once your VM is running, you can access to the its administration page by clinking on its <code>Instance ID</code></label></p>
<p><a href="img/ec2_accueil_instance.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="img/ec2_accueil_instance.png" class="img-fluid"></a></p></li>
</ul>
<p>You will find much information, but the most important one is its <code>Public IPv4 address</code> which is its IP address (Internet Protocol) used to access your machine from outside AWS.</p>
<section id="windows-user" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="windows-user"><span class="header-section-number">7.1</span> Windows user</h3>
<ul class="task-list">
<li><label><input type="checkbox">Run <code>PuTTY</code> application</label>
<ul>
<li>Windows &gt; 5-Informatique &gt; PuTTY</li>
</ul></li>
<li><label><input type="checkbox">Host Name: paste your <code>Public IPv4 address</code></label></li>
<li><label><input type="checkbox">Saved Session: <code>AWS EC2</code></label></li>
<li><label><input type="checkbox">Click on <code>Save</code> <img src="img/putty1.png" class="img-fluid"></label></li>
<li><label><input type="checkbox">Then go to <code>SSH &gt; Auth &gt; Credentials</code></label></li>
<li><label><input type="checkbox">Private key file for authentification : <em>your labsuser.ppk file</em> (see download folder) <img src="img/putty2.png" class="img-fluid"></label></li>
<li><label><input type="checkbox">Go back to the first screen (Session menu),</label></li>
<li><label><input type="checkbox">Click on your session name, <code>Save</code> then <code>Open</code>. <img src="img/putty3.png" class="img-fluid"></label></li>
<li><label><input type="checkbox">A similar windows will pop up, click on <code>Accept</code> <img src="img/putty_warning.png" class="img-fluid"></label></li>
</ul>
<p>Now a terminal will open</p>
<ul class="task-list">
<li><label><input type="checkbox">Login as: <code>ec2-user</code></label></li>
<li><label><input type="checkbox">then press <code>Enter</code>(<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/connection-prereqs.html" class="external" target="_blank">documentation</a>) <img src="img/terminal_ec2.png" class="img-fluid"></label></li>
</ul>
<p>Tada ! your are connected to your virtual machine. <strong>Although, this terminal is on your computer, every command you type are executed on the remote machine</strong>. This make it possible to run huge computation without altering your own performance. But, this machine do not have any graphical interface (GUI), so you need so basics of shell command.</p>
</section>
<section id="macoslinux-user" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="macoslinux-user"><span class="header-section-number">7.2</span> macOS/Linux user</h3>
<ul class="task-list">
<li><p><label><input type="checkbox">In the previously open terminal type</label></p>
<pre><code>ssh -i labsuser.pem ec2-user@[public-ip]</code></pre>
<p>Replace [public-ip] by your public ip</p></li>
</ul>
</section>
</section>
<section id="play-with-your-vm" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="play-with-your-vm"><span class="header-section-number">8</span> Play with your VM</h2>
<p>In this section you will learn some basics of shell, and reproduce the benchmark of language made in the first lesson. You will:</p>
<ol type="1">
<li>Get all the files for the benchmark</li>
<li>Install R and a python package on your machine</li>
<li>Run the benchmark</li>
</ol>
<p>This benchmark compare the time to compute the max temperature for some year based on the USA weather data. Each file contains all the weather data for one year, and each record is a weather observation. An observation looks like this:</p>
<pre><code>0029029070999991901010106004+64333+023450FM-12+000599999V0202701N015919999999N0000001N9-00781+99999102001ADDGF108991999999999999999999</code></pre>
<p>It’s a positional file, with the temperature at the position [87, 91] and it’s quality at position 91. In the example the temperature is -0078 deca Celsius (so -7.8°C), with a quality of 1 (a good quality). Each program loads line by line the data and computes the max by updating the current max value (so a <span class="math inline">\(\mathcal{O}(n)\)</span> in computation time and <span class="math inline">\(\mathcal{O}(1)\)</span> in memory) (expect for R that load all the data in memory so <span class="math inline">\(\mathcal{O}(n)\)</span> in memory). But each language has its specificities:</p>
<ul>
<li>python: dynamic typing, just in time compilation to byte code then interpreted by python</li>
<li>java: static typing, ahead of time compilation to byte code then interpreted by java</li>
<li>C: statis typing, ahead of time compilation to machine code then executed by the OS</li>
<li>bash: no type like python/java/C, interpeted by your OS</li>
</ul>
<p>Here is some bash commands</p>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 66%">
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sudo</td>
<td>Super user : basically you have all the rights</td>
</tr>
<tr class="even">
<td>cd [target_directory]</td>
<td>Change directory : move in the file tree. To go to the parent directory do <code>cd ../</code></td>
</tr>
<tr class="odd">
<td>ls (or ll)</td>
<td>List : list all the file in the current directory</td>
</tr>
<tr class="even">
<td>mkdir [directory_name]</td>
<td>Make directory : create a directory</td>
</tr>
<tr class="odd">
<td>rm [file_name]</td>
<td>Remove : remove a file. You cannot remove a none empty directory by default. You should use the <code>rm [file_name] -r</code> to do so. <br> <span class="emoji" data-emoji="warning">⚠️</span> <strong>NEVER</strong> execute the command <code>rm -rf /</code> because you will remove all the files on the current machine</td>
</tr>
<tr class="even">
<td>chmod 764 [file_name]</td>
<td>Change mode : change the access right ofyour files. Without more detail, the access right 764 gives read, write and execution rights to the owner of the file.</td>
</tr>
<tr class="odd">
<td>unzip [file_name]</td>
<td>Unzip : unzip files</td>
</tr>
<tr class="even">
<td>yum install [package]</td>
<td>Package manager for some linux distribution. It’s like pip but for Linux.</td>
</tr>
<tr class="odd">
<td>aws s3 cp [s3://URI]</td>
<td>Specific AWS command. Copy file from s3 to the current machine</td>
</tr>
<tr class="even">
<td>amazon-linux-extras [package]</td>
<td>Like yum but for amazon machine.</td>
</tr>
</tbody>
</table>
<section id="benchmark-setup" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="benchmark-setup"><span class="header-section-number">8.1</span> Benchmark setup</h3>
<p>In the terminal :</p>
<ul class="task-list">
<li><label><input type="checkbox">Download the file stored on S3.</label>
<ul>
<li>Use the command <code>aws s3 cp &lt;s3://URI&gt; &lt;output_folder&gt;</code></li>
<li>Replace <code>&lt;s3://URI&gt;</code> with the URI of the file you upload in your S3 bucket</li>
<li>Replace <code>&lt;output_folder&gt;</code> with <code>.</code> (current directory)</li>
<li>You should get a command like this : <code>aws s3 cp s3://ensai-ldeneuville-20240430/lab0_files.zip .</code></li>
</ul></li>
<li><label><input type="checkbox">With <code>ls</code>, check you downloaded the file</label></li>
<li><label><input type="checkbox">Now you will unzip your file with <code>unzip &lt;file_name&gt;</code>.</label></li>
<li><label><input type="checkbox">Check the result with <code>ls</code></label></li>
<li><label><input type="checkbox">For security reasons, you cannot execute your files. Do <code>chmod 764 get_data.sh awk.sh GetMaxTempC</code> to change that.</label>
<ul>
<li>For more details, the <a href="https://fr.wikipedia.org/wiki/Chmod" target="_blank">chmod wikipedia page</a> provides more details.</li>
</ul></li>
<li><label><input type="checkbox">Now you will execute the <em>get_data.sh</em> script. Just type<code>./get_data.sh</code></label>
<ul>
<li>This script download some data from the NOAA (~ météo france in the USA) server</li>
</ul></li>
</ul>
</section>
<section id="install-r-java-c-compiler-and-a-python-package" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="install-r-java-c-compiler-and-a-python-package"><span class="header-section-number">8.2</span> Install R, java, C compiler and a python package</h3>
<p>Your VM doesn’t have all the require packages for the benchmark.</p>
<ul class="task-list">
<li><label><input type="checkbox"><strong>python-dev installation</strong> : <em>python-devel</em> is require to create extension for python.</label>
<ul>
<li>To install it use <em>yum</em>, a package manager for Linux.</li>
<li>The exact command is <code>sudo yum install -y python3-devel.x86_64</code>
<ul>
<li><em>sudo</em>: to have super user right,</li>
<li><em>yum</em>: to use the package manager,</li>
<li><em>install</em>: to install a package,</li>
<li><em>-y</em>: to validate the installation,</li>
<li><em>python3-devel.x86_64</em>: the package name</li>
</ul></li>
</ul></li>
<li><label><input type="checkbox"><strong>Java and GCC installation</strong></label>
<ul>
<li>in the same way, install java and GCC with <code>sudo yum install java gcc -y</code></li>
</ul></li>
<li><label><input type="checkbox"><strong>Cython installation</strong>:</label>
<ul>
<li>install <em>Cython</em> and then compile the Cython code:</li>
<li><code>pip3 install Cython</code></li>
<li><code>cd cython_code</code>: change directory and go in the <em>cython_code</em> directory</li>
<li><code>python3 setup.py build_ext --inplace</code> to run the compilation</li>
<li><code>cd ..</code> to go back to the parent folder</li>
</ul></li>
<li><label><input type="checkbox"><strong>R installation</strong> : to install R, you will use the amazon custome package manager <code>amazon-linux-extras</code>,</label>
<ul>
<li>with the following command : <code>sudo amazon-linux-extras install R4 -y</code>.</li>
<li>Just wait 1-2 minutes.</li>
</ul></li>
</ul>
</section>
<section id="benchmark" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="benchmark"><span class="header-section-number">8.3</span> Benchmark</h3>
<p>Now it’s time to run the benchmark. To do so, you will use the <code>time</code> command. <code>time</code> compute the execution time of the following command. For example : <code>time ./get_data.sh</code> . Write all the results, and compare then with the course. If results are different, try to understand why.</p>
<ul class="task-list">
<li><label><input type="checkbox">To run compiled C or bash : <code>time ./[file]</code></label></li>
<li><label><input type="checkbox">To run compiled java :<code>time java -jar [file.jar]</code></label></li>
<li><label><input type="checkbox">To run python :<code>time python3 [file.py]</code></label></li>
<li><label><input type="checkbox">To run R script : <code>time Rscript [filename.R]</code></label></li>
</ul>
<p>Which one is the fastest and the slowest ?</p>
<ul class="task-list">
<li><label><input type="checkbox">Once it’s done, close your terminal</label></li>
</ul>
</section>
<section id="a-shell-in-your-web-browser" class="level3" data-number="8.4">
<h3 data-number="8.4" class="anchored" data-anchor-id="a-shell-in-your-web-browser"><span class="header-section-number">8.4</span> A shell in your web browser</h3>
<ul class="task-list">
<li><label><input type="checkbox">Go back to your EC2 instance page</label></li>
<li><label><input type="checkbox">Click on <code>Connect</code> and then <code>Connect</code> <img src="img/ec2_se_connecter.png" class="img-fluid"> <img src="img/ec2_se_connecter_2.png" class="img-fluid"></label></li>
</ul>
<p>After 30 seconds you can use a <em>cloud shell</em>. You can do the same thing with your cloud shell as the previous SSH shell.</p>
<p><a href="img/cloud_shell.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="img/cloud_shell.png" class="img-fluid"></a></p>
<ul class="task-list">
<li><label><input type="checkbox">Type <code>ls</code> to check if your files are still there.</label></li>
</ul>
</section>
</section>
<section id="shut-down-your-machine" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="shut-down-your-machine">Shut down your machine</h2>
<p>Because your EC2 instance is billed by time and not usage, once your work is done, shut down it. Although the cost is small, a small cost*24*7 for 1 week or running instance can cost 10$. And for bigger machine in a company maybe 100$ or 1000$.</p>
<p>To shut down your machine :</p>
<ul class="task-list">
<li><label><input type="checkbox">go to <code>EC2 &gt; Instances</code> and find all running instances</label></li>
<li><label><input type="checkbox">Click on <code>Instance state</code></label></li>
<li><label><input type="checkbox">then on <code>Terminate instance</code></label></li>
</ul>
<p><a href="img/ec2_end.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="img/ec2_end.png" class="img-fluid"></a></p>
</section>
<section id="prepare-next-lab" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="prepare-next-lab">Prepare next Lab</h2>
<p>If you plan to continue on AWS (recommended for engineers), follow <a href="../../../docs/lab/aws-cluster-spark.html">these instructions</a> to prepare for the next lab.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ludo2ne\.github\.io\/ENSAI-2A-Big-Data\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Website built with <a href="https://quarto.org/" class="external" target="_blank">Quarto</a> <br> <a href="https://github.com/ludo2ne/ENSAI-2A-Big-Data" class="external" target="_blank">Source code</a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","selector":".lightbox","closeEffect":"zoom","loop":false,"openEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>